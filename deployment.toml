[server]
hostname = "wso2-7-ecare-a-gw-svc-ci-staging"
# node_ip = "$env{NODE_IP}"

[super_admin]
username = "admin"
password = "admin"
create_admin_account = true

[database.shared_db]
type = "mysql"
url = "jdbc:mysql://10.50.13.228:3306/Abdullah_SHARED_DB?autoReconnect=true&amp;relaxAutoCommit=true&amp;useSSL=false&amp;failOverReadOnly=false"
username = "devteam"
password = "Dev_Team123"
driver = "com.mysql.cj.jdbc.Driver"

[apim.sync_runtime_artifacts.gateway]
gateway_labels = ["wso2-3-rev-ecare-gw"]

[apim.event_hub]
enable = true
service_url = "https://wso2-cp-a-svc-lb-staging:9443/services/"
username = "$ref{super_admin.username}"
password = "$ref{super_admin.password}"
event_listening_endpoints = ["tcp://wso2-cp-a-svc-lb-staging:5672"]

# -----------------------------
# ✅ Throttling (Traffic Manager) Configuration
# -----------------------------
[apim.throttling]
throttle_decision_endpoints = ["tcp://wso2-tm-a-svc-ci-staging:5672"]

[[apim.throttling.url_group]]
traffic_manager_urls = ["tcp://wso2-tm-a-svc-ci-staging:9611"]
traffic_manager_auth_urls = ["ssl://wso2-tm-a-svc-ci-staging:9711"]

# Credentials for communication with TM
username = "admin"
password = "admin"
enable_data_publishing = true

# -----------------------------
# ✅ Cache and OAuth Configuration
# -----------------------------
[apim.cache.gateway_token]
enable = true
expiry_time = 15

[apim.cache.resource]
enable = true

[apim.cache.jwt_claim]
enable = true
expiry_time = 900

[apim.oauth_config]
remove_outbound_auth_header = true
auth_header = "Authorization"

# -----------------------------
# ✅ CORS Configuration
# -----------------------------
[apim.cors]
allow_origins = "*"
allow_methods = ["GET", "PUT", "POST", "DELETE", "PATCH", "OPTIONS"]
allow_headers = ["authorization", "Access-Control-Allow-Origin", "Content-Type", "SOAPAction", "apikey", "Internal-Key"]
allow_credentials = false

# -----------------------------
# ✅ User Store Configuration
# -----------------------------
[user_store]
type = "database_unique_id"
class = "org.wso2.carbon.user.core.jdbc.UniqueIDJDBCUserStoreManager"
tenant_manager = "org.wso2.carbon.user.core.tenant.JDBCTenantManager"
